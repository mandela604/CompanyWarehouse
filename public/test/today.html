<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WareAdmin - Record Sale Modal DEMO</title>
  <style>
    :root {
      --blue: #0b5ed7;
      --dark-red: #b71c1c;
      --success: #10b981;
      --bg: #f8fafc;
      --card: white;
      --muted: #6b7280;
      --radius: 10px;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacC, "Segoe UI", Roboto, sans-serif;
      background: #eef2f6;
      color: #111827;
      padding: 30px;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal {
      background: white;
      border-radius: 12px;
      width: 100%;
      max-width: 720px;
      padding: 24px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
      position: relative;
    }

    h3 {
      margin: 0 0 20px;
      color: var(--blue);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0;
    }

    th, td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }

    th {
      background: #f8fafc;
      font-weight: 600;
      color: var(--muted);
      font-size: 13px;
      text-transform: uppercase;
    }

    input[type="number"] {
      width: 100%;
      padding: 6px 8px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      font-size: 14px;
      text-align: right;
    }

    .price-input {
      width: 120px !important;
      text-align: right;
    }

    .btn {
      padding: 10px 18px;
      border-radius: 8px;
      border: none;
      font-weight: 600;
      cursor: pointer;
    }

    .btn.primary {
      background: var(--blue);
      color: white;
    }

    .btn.secondary {
      background: #f3f4f6;
      color: #374151;
    }

    .btn.danger {
      background: #ef4444;
      color: white;
    }

    .total-row {
      font-size: 18px;
      font-weight: bold;
      background: #eff6ff;
      margin-top: 12px;
    }

    .grand-total {
      color: var(--blue);
    }

    .product-select {
      width: 100%;
      padding: 10px;
      border: 1px solid #d1d5db;
      border-radius: 6px;
      margin-bottom: 12px;
    }

    .add-row {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    .add-row input {
      flex: 1;
    }
  </style>
</head>
<body>

  <h2 style="text-align:center; margin-bottom:40px;">Record Sale Modal - DEMO<br><small>(Price is now editable)</small></h2>

  <div class="modal-backdrop" id="backdrop" style="display:flex;">
    <div class="modal">

      <h3>Record Sale (Multiple Products)</h3>

      <table>
        <thead>
          <tr>
            <th>Product</th>
            <th style="width:90px;">Qty</th>
            <th style="width:140px;">Unit Price</th>
            <th style="width:110px;">Total</th>
            <th style="width:40px;"></th>
          </tr>
        </thead>
        <tbody id="saleItems">
          <!-- Filled by JS -->
        </tbody>
      </table>

      <!-- Demo controls -->
      <div style="margin:20px 0; padding:16px; background:#f1f5f9; border-radius:8px;">
        <select id="productSelect" class="product-select">
          <option value="">Select product to add...</option>
          <option value="p1" data-price="4500" data-qty="38">Indomie Regular (38 left) — ₦4,500</option>
          <option value="p2" data-price="28500" data-qty="14">Peak Milk 900g (14 left) — ₦28,500</option>
          <option value="p3" data-price="1200" data-qty="67">Coca-Cola 50cl PET (67 left) — ₦1,200</option>
          <option value="p4" data-price="18500" data-qty="9">Golden Penny Oil 4L (9 left) — ₦18,500</option>
          <option value="p5" data-price="3200" data-qty="42">Dano Milk 380g (42 left) — ₦3,200</option>
        </select>

        <div class="add-row">
          <input type="number" id="qtyInput" min="1" value="1" placeholder="Quantity">
          <button class="btn primary" id="addItemBtn">+ Add Item</button>
        </div>
      </div>

      <div style="text-align:right; font-size:22px; font-weight:bold; margin:24px 0;">
        Grand Total: <span id="grandTotal" class="grand-total">₦0</span>
      </div>

      <div style="text-align:right;">
        <button class="btn secondary">Cancel</button>
        <button class="btn primary" id="confirmSale" disabled>Complete Sale</button>
      </div>

    </div>
  </div>

  <script>
    let saleCart = [];

    const products = {
      p1: { name: "Indomie Regular", price: 4500 },
      p2: { name: "Peak Milk 900g", price: 28500 },
      p3: { name: "Coca-Cola 50cl PET", price: 1200 },
      p4: { name: "Golden Penny Oil 4L", price: 18500 },
      p5: { name: "Dano Milk 380g", price: 3200 }
    };

    function renderCart() {
      const tbody = document.getElementById('saleItems');
      if (saleCart.length === 0) {
        tbody.innerHTML = `<tr><td colspan="5" style="text-align:center; color:#888; padding:40px 0;">
          No items added yet...
        </td></tr>`;
        document.getElementById('grandTotal').textContent = '₦0';
        document.getElementById('confirmSale').disabled = true;
        return;
      }

      let grand = 0;
      tbody.innerHTML = saleCart.map((item, i) => {
        const total = item.qty * item.price;
        grand += total;

        return `
          <tr>
            <td><strong>${item.name}</strong></td>
            <td>
              <input type="number" min="1" value="${item.qty}" 
                     onchange="updateQty(${i}, this.value)"
                     style="width:80px; text-align:center;">
            </td>
            <td>
              <input type="number" step="0.01" min="0" 
                     value="${item.price.toFixed(2)}"
                     class="price-input"
                     onchange="updatePrice(${i}, this.value)">
            </td>
            <td style="text-align:right; font-weight:600;">
              ₦${total.toLocaleString()}
            </td>
            <td>
              <button onclick="removeItem(${i})" 
                      style="color:#ef4444; background:none; border:none; font-size:18px; cursor:pointer;">
                ×
              </button>
            </td>
          </tr>
        `;
      }).join('');

      document.getElementById('grandTotal').textContent = 
        '₦' + grand.toLocaleString();
      
      document.getElementById('confirmSale').disabled = false;
    }

    function updateQty(index, value) {
      const qty = Math.max(1, parseInt(value) || 1);
      saleCart[index].qty = qty;
      renderCart();
    }

    function updatePrice(index, value) {
      let price = parseFloat(value) || 0;
      if (price < 0) price = 0;
      saleCart[index].price = price;
      renderCart();
    }

    function removeItem(index) {
      saleCart.splice(index, 1);
      renderCart();
    }

    // Add item
    document.getElementById('addItemBtn').onclick = () => {
      const select = document.getElementById('productSelect');
      const qtyInput = document.getElementById('qtyInput');

      if (!select.value) return alert('Please select a product');
      
      const qty = Math.max(1, parseInt(qtyInput.value) || 1);
      const product = products[select.value];

      const existingIndex = saleCart.findIndex(item => item.id === select.value);
      if (existingIndex !== -1) {
        saleCart[existingIndex].qty += qty;
      } else {
        saleCart.push({
          id: select.value,
          name: product.name,
          price: product.price,
          qty: qty
        });
      }

      qtyInput.value = "1";
      select.value = "";
      renderCart();
    };

    // Initial render
    renderCart();

    // Just for demo - auto add one item
    setTimeout(() => {
      saleCart.push({ id: "p2", name: "Peak Milk 900g", price: 28500, qty: 2 });
      saleCart.push({ id: "p3", name: "Coca-Cola 50cl PET", price: 1200, qty: 5 });
      renderCart();
    }, 800);
  </script>
</body>
</html>